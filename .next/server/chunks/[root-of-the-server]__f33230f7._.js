module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},29173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},96187,(e,t,r)=>{t.exports=e.x("jsonwebtoken",()=>require("jsonwebtoken"))},3064,e=>{"use strict";var t=e.i(96187),r=e.i(29173);let i=e.g.__prisma||new r.PrismaClient;e.g.__prisma||(e.g.__prisma=i);let a=process.env.JWT_SECRET||"dev-secret";function n(e){return t.default.sign(e,a,{expiresIn:"7d"})}async function s(e){let r=function(e){try{return t.default.verify(e,a)}catch(e){return null}}(e);return r&&r.userId?await i.user.findUnique({where:{id:r.userId}}):null}e.s(["getUserFromToken",()=>s,"signToken",()=>n])},85515,e=>{"use strict";var t=e.i(26747),r=e.i(90406),i=e.i(44898),a=e.i(62950),n=e.i(3064),s=e.i(29173);let o=e.g.__prisma||new s.PrismaClient;async function l(e,t){let r=e.headers.authorization,i=r&&r.startsWith("Bearer ")?r.slice(7):null,a=i?await (0,n.getUserFromToken)(i):null;if(!a)return t.status(401).json({error:"Unauthorized"});if(!["ADMIN","TEAM_MEMBER"].includes(a.role))return t.status(403).json({error:"Insufficient permissions"});try{if("GET"===e.method){let e=(await o.donor.findMany({orderBy:{lastGiftAt:"desc"}})).map(e=>({id:e.id,firstName:e.firstName,lastName:e.lastName,email:e.email,phone:e.phone,city:e.city,state:e.state,zipcode:e.zipcode,active:e.active,totalGiving:e.totalGiving,lastGiftAt:e.lastGiftAt}));return t.status(200).json({donors:e})}if("POST"===e.method){let{firstName:r,lastName:i,email:a,phone:n,notes:s,city:l,state:d,zipcode:u,active:p}=e.body||{};if(!r||!a)return t.status(400).json({error:"firstName and email required"});let c=await o.donor.create({data:{firstName:r,lastName:i,email:a,phone:n,notes:s,city:l,state:d,zipcode:u,active:"boolean"!=typeof p||p}});return t.status(201).json({donor:{id:c.id,firstName:c.firstName,lastName:c.lastName,email:c.email,phone:c.phone,city:c.city,state:c.state,zipcode:c.zipcode,active:c.active,totalGiving:c.totalGiving}})}return t.status(405).json({error:"Method not allowed"})}catch(e){return console.error("Donors API error",e),t.status(500).json({error:"Server error",details:String(e)})}}e.g.__prisma||(e.g.__prisma=o),e.s(["default",()=>l],53582);var d=e.i(53582),u=e.i(7031),p=e.i(81927),c=e.i(46432);let m=(0,a.hoist)(d,"default"),f=(0,a.hoist)(d,"config"),v=new i.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/donors/index",pathname:"/api/donors",bundlePath:"",filename:""},userland:d,distDir:".next",relativeProjectDir:""});async function h(e,r,i){v.isDev&&(0,c.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/donors/index";a=a.replace(/\/index$/,"")||"/";let n=await v.prepare(e,r,{srcPage:a});if(!n){r.statusCode=400,r.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve());return}let{query:s,params:o,prerenderManifest:l,routerServerContext:d}=n;try{let t=e.method||"GET",i=(0,u.getTracer)(),n=i.getActiveScopeSpan(),c=v.instrumentationOnRequestError.bind(v),m=async n=>v.render(e,r,{query:{...s,...o},params:o,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:v.isDev,page:"/api/donors/index",internalRevalidate:null==d?void 0:d.revalidate,onError:(...t)=>c(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let e=i.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=e.get("next.route");if(s){let e=`${t} ${s}`;n.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),n.updateName(e)}else n.updateName(`${t} ${a}`)});n?await m(n):await i.withPropagatedContext(e.headers,()=>i.trace(p.BaseServerSpan.handleRequest,{spanName:`${t} ${a}`,kind:u.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},m))}catch(e){if(v.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==i.waitUntil||i.waitUntil.call(i,Promise.resolve())}}e.s(["config",0,f,"default",0,m,"handler",()=>h],85515)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f33230f7._.js.map