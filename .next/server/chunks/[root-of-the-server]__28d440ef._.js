module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},29173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},96187,(e,t,r)=>{t.exports=e.x("jsonwebtoken",()=>require("jsonwebtoken"))},3064,e=>{"use strict";var t=e.i(96187),r=e.i(29173);let i=e.g.__prisma||new r.PrismaClient;e.g.__prisma||(e.g.__prisma=i);let a=process.env.JWT_SECRET||"dev-secret";function n(e){return t.default.sign(e,a,{expiresIn:"7d"})}async function s(e){let r=function(e){try{return t.default.verify(e,a)}catch(e){return null}}(e);return r&&r.userId?await i.user.findUnique({where:{id:r.userId}}):null}e.s(["getUserFromToken",()=>s,"signToken",()=>n])},18510,(e,t,r)=>{t.exports=e.x("bcryptjs",()=>require("bcryptjs"))},96428,e=>{"use strict";let t;var r=e.i(26747),i=e.i(90406),a=e.i(44898),n=e.i(62950),s=e.i(29173),o=e.i(3064),l=e.i(18510);async function u(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});let{email:i,password:a}=e.body||{};if(!i||!a)return r.status(400).json({error:"Missing email or password"});let n=String(i||"").trim().toLowerCase();try{let e=await t.user.findUnique({where:{email:n}});if(!e)try{(e=await t.user.findFirst({where:{email:{equals:n,mode:"insensitive"}}}))&&console.warn("Login: matched user with case-insensitive email lookup for",n)}catch(r){try{(e=await t.user.findFirst({where:{email:{contains:n}}}))&&console.warn("Login: matched user using fallback contains lookup for",n)}catch(e){}}if(!e)return r.status(401).json({error:"Invalid credentials"});let i=String(e.password||""),s=!1;if(/^\$2[aby]\$/.test(i))s=await l.default.compare(a,i);else if(i===a){s=!0;try{let r=await l.default.hash(a,10);await t.user.update({where:{id:e.id},data:{password:r}})}catch(t){console.warn("Failed to re-hash legacy password for",e.email,t)}}if(!s)return console.warn("Login failed for",n),r.status(401).json({error:"Invalid credentials"});let u=(0,o.signToken)({userId:e.id,email:e.email});return r.status(201).json({ok:!0,token:u,user:{id:e.id,email:e.email,name:e.name,role:e.role}})}catch(e){return r.status(500).json({error:e.message})}}e.g.__prisma||(e.g.__prisma=new s.PrismaClient),t=e.g.__prisma,e.s(["default",()=>u],35117);var d=e.i(35117),p=e.i(7031),c=e.i(81927),m=e.i(46432);let h=(0,n.hoist)(d,"default"),f=(0,n.hoist)(d,"config"),w=new a.PagesAPIRouteModule({definition:{kind:i.RouteKind.PAGES_API,page:"/api/auth/login",pathname:"/api/auth/login",bundlePath:"",filename:""},userland:d,distDir:".next",relativeProjectDir:""});async function g(e,t,i){w.isDev&&(0,m.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/auth/login";a=a.replace(/\/index$/,"")||"/";let n=await w.prepare(e,t,{srcPage:a});if(!n){t.statusCode=400,t.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve());return}let{query:s,params:o,prerenderManifest:l,routerServerContext:u}=n;try{let r=e.method||"GET",i=(0,p.getTracer)(),n=i.getActiveScopeSpan(),d=w.instrumentationOnRequestError.bind(w),m=async n=>w.render(e,t,{query:{...s,...o},params:o,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:w.isDev,page:"/api/auth/login",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>d(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let e=i.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=e.get("next.route");if(s){let e=`${r} ${s}`;n.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),n.updateName(e)}else n.updateName(`${r} ${a}`)});n?await m(n):await i.withPropagatedContext(e.headers,()=>i.trace(c.BaseServerSpan.handleRequest,{spanName:`${r} ${a}`,kind:p.SpanKind.SERVER,attributes:{"http.method":r,"http.target":e.url}},m))}catch(e){if(w.isDev)throw e;(0,r.sendError)(t,500,"Internal Server Error")}finally{null==i.waitUntil||i.waitUntil.call(i,Promise.resolve())}}e.s(["config",0,f,"default",0,h,"handler",()=>g],96428)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__28d440ef._.js.map