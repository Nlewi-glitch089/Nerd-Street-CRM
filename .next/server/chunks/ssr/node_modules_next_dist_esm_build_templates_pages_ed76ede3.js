module.exports=[58456,a=>{"use strict";var b=a.i(79168),c=a.i(27068),d=a.i(32759),e=a.i(39141),f=a.i(27342),g=a.i(8171),h=a.i(27669),i=a.i(41910);function j(){let a,b,c,d,e,f=(0,i.useRouter)(),[j,k]=(0,h.useState)(!0),[l,m]=(0,h.useState)(null),[n,o]=(0,h.useState)(null),[p,q]=(0,h.useState)([]),[r,s]=(0,h.useState)([]),[t,u]=(0,h.useState)([]),[v,w]=(0,h.useState)([]),[x,y]=(0,h.useState)([]),[z,A]=(0,h.useState)([]),[B,C]=(0,h.useState)(null),[D,E]=(0,h.useState)("analytics"),[F,G]=(0,h.useState)([]),[H,I]=(0,h.useState)(""),[J,K]=(0,h.useState)(null),[L,M]=(0,h.useState)(null),[N,O]=(0,h.useState)(null),[P,Q]=(0,h.useState)([]),[R,S]=(0,h.useState)(!1),[T,U]=(0,h.useState)(""),[V,W]=(0,h.useState)(!1),[X,Y]=(0,h.useState)(null),[Z,$]=(0,h.useState)(!1),[_,aa]=(0,h.useState)(null),[ab,ac]=(0,h.useState)(null),[ad,ae]=(0,h.useState)(""),[af,ag]=(0,h.useState)(!1),[ah,ai]=(0,h.useState)(null),[aj,ak]=(0,h.useState)(!1),[al,am]=(0,h.useState)(null),[an,ao]=(0,h.useState)(null),[ap,aq]=(0,h.useState)(""),[ar,as]=(0,h.useState)(!1),[at,au]=(0,h.useState)(null),[av,aw]=(0,h.useState)(!1),[ax,ay]=(0,h.useState)(null),[az,aA]=(0,h.useState)(""),[aB,aC]=(0,h.useState)(!1),[aD,aE]=(0,h.useState)(null);async function aF(){try{let a=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})(),b=await fetch("/api/seed",{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}}});if(!b.ok)return console.warn("Seed API failed, falling back to local seed"),aG();let c=await b.json();return q(c.metrics||[]),s(c.partners||[]),y(c.donors||[]),A(c.campaigns||[]),u(c.recentActivity||[]),w(c.alerts||[]),C(c.analytics||null),c}catch(a){return console.warn("Seed failed",a),aG()}}function aG(){return q([{title:"Active Programs",value:"1",sub:"Running programs"},{title:"Total Revenue",value:"$500,000",sub:"From all programs"},{title:"Team Reminders",value:"0",sub:"Action items pending"}]),s([{name:"GameStop",tag:"At Risk",health:"45%"},{name:"Discord",tag:"Pending",health:"70%"},{name:"Alienware",tag:"Active",health:"85%"},{name:"Red Bull Gaming",tag:"Active",health:"92%"}]),y([{name:"Nate Marshall",totalGiving:"$12,500",lastGift:"Mar 3, 2025"},{name:"Evelyn Hart",totalGiving:"$4,200",lastGift:"Jan 12, 2025"}]),A([{title:"Spring Fundraiser 2025",goal:"$75,000",raised:"$12,000"},{title:"Community Outreach Q2",goal:"$20,000",raised:"$5,000"}]),u([{title:"Alienware",kind:"Email",note:"Equipment delivery confirmed for new venue opening.",date:"Dec 7, 2025"},{title:"Red Bull Gaming",kind:"Meeting",note:"Discussed Q1 2025 tournament schedule and activation opportunities.",date:"Dec 4, 2025"}]),w([{title:"Alienware",note:"Send co-marketing proposal and content calendar — Due: Dec 14, 2025"},{title:"Red Bull Gaming",note:"Reach out to discuss 2025 renewal terms — Due: Dec 19, 2025"}]),C({visitors:1234,conversions:42,revenue:5e5}),{metrics:[{title:"Active Programs",value:"1",sub:"Running programs"},{title:"Total Revenue",value:"$500,000",sub:"From all programs"},{title:"Team Reminders",value:"0",sub:"Action items pending"}],partners:[{name:"GameStop",tag:"At Risk",health:"45%"},{name:"Discord",tag:"Pending",health:"70%"},{name:"Alienware",tag:"Active",health:"85%"},{name:"Red Bull Gaming",tag:"Active",health:"92%"}],donors:[{name:"Nate Marshall",totalGiving:"$12,500",lastGift:"Mar 3, 2025"},{name:"Evelyn Hart",totalGiving:"$4,200",lastGift:"Jan 12, 2025"}],campaigns:[{title:"Spring Fundraiser 2025",goal:"$75,000",raised:"$12,000"},{title:"Community Outreach Q2",goal:"$20,000",raised:"$5,000"}],recentActivity:[{title:"Alienware",kind:"Email",note:"Equipment delivery confirmed for new venue opening.",date:"Dec 7, 2025"},{title:"Red Bull Gaming",kind:"Meeting",note:"Discussed Q1 2025 tournament schedule and activation opportunities.",date:"Dec 4, 2025"}],alerts:[{title:"Alienware",note:"Send co-marketing proposal and content calendar — Due: Dec 14, 2025"},{title:"Red Bull Gaming",note:"Reach out to discuss 2025 renewal terms — Due: Dec 19, 2025"}],analytics:{visitors:1234,conversions:42,revenue:5e5}}}async function aH(a){try{let b=await fetch("/api/users"),c=await b.json(),d=c;if(!c||(0===c.totalRevenue||null==c.totalRevenue)&&(0===c.totalDonors||null==c.totalDonors)&&(!Array.isArray(c.campaignStats)||0===c.campaignStats.length))try{let a=await aF();a&&(d=a.analytics||a)}catch(a){console.warn("Auto-seed failed",a)}K(d);let e=[];if(Array.isArray(c)?e=c:Array.isArray(c?.users)?e=c.users:Array.isArray(d?.users)&&(e=d.users),!e||0===e.length)try{a?e=[a]:l&&(e=[l])}catch(a){e=[]}G(e||[])}catch(a){console.warn("loadUsers failed",a)}}async function aI(){try{let a=await fetch("/api/campaigns");if(!a.ok)return;let b=await a.json();if(!b||!Array.isArray(b.campaigns)||0===b.campaigns.length)try{let a=await aF();if(a&&Array.isArray(a.campaigns)){A(a.campaigns),Q(a.campaigns);return}}catch(a){console.warn("Auto-seed for campaigns failed",a)}A(b.campaigns||[]),Q(b.campaigns||[])}catch(a){console.warn(a)}}async function aJ(){try{let a=await fetch("/api/analytics");if(!a.ok)return;let b=await a.json();if(!b||(0===b.totalRevenue||null==b.totalRevenue)&&(!Array.isArray(b.campaignStats)||0===b.campaignStats.length))try{let a=await aF();if(a)return void K(a.analytics||a)}catch(a){console.warn("Auto-seed for analytics failed",a)}try{let a=await fetch("/api/campaigns");if(a.ok){let c=await a.json(),d=Array.isArray(c.campaigns)?c.campaigns:[];if(Array.isArray(b.campaignStats)&&b.campaignStats.length>0&&d.length>0){let a=d.reduce((a,b)=>(b.id&&(a[b.id]=b),a[b.name]=a[b.name]||b,a),{}),c=b.campaignStats.map(b=>{let c=b.id&&a[b.id]||a[b.name];if(!c)return b;let d=Number(b.raised||0),e=Number(c.raised||c.raisedAmount||0),f=Number(b.gifted||b.giftedRaised||0),g=Number(c.giftedRaised||c.gifted||0);return{...b,raised:d&&d>0?d:e,gifted:f&&f>0?f:g}});b.campaignStats=c}}}catch(a){console.warn("Failed to enrich analytics with /api/campaigns data",a)}K(b||null)}catch(a){console.warn(a)}}(0,h.useEffect)(()=>{let a=!0;return(async()=>{try{let b=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})();if(!b){a&&o("Not authenticated");return}let c=await fetch("/api/protected",{headers:{Authorization:`Bearer ${b}`}});if(!c.ok){a&&o("Session invalid or expired");try{localStorage.removeItem("token")}catch(a){}return}let d=await c.json();if(!d?.user){a&&o("Unable to load user");return}if("ADMIN"!==d.user.role){a&&o("Unauthorized — admin access required");return}a&&m(d.user),a&&(aH(d.user).catch(()=>{}),aI().catch(()=>{}),aJ().catch(()=>{}))}catch(b){a&&o("Network error")}finally{a&&k(!1)}})(),()=>{a=!1}},[]);let[aK,aL]=(0,h.useState)(!1),[aM,aN]=(0,h.useState)(null),[aO,aP]=(0,h.useState)(!1),[aQ,aR]=(0,h.useState)(null);return((()=>{if(J){let a=Array.isArray(J.campaignStats)?J.campaignStats.reduce((a,b)=>a+(Number(b.raised||0)||0),0):0,b=Array.isArray(J.donorStats)?J.donorStats.reduce((a,b)=>a+(Number(b.totalGiving||0)||0),0):0,c=Math.max(b||0,a||0);return a.toLocaleString&&a.toLocaleString(),b.toLocaleString&&b.toLocaleString(),c.toLocaleString&&c.toLocaleString()}Array.isArray(p)&&p.length})(),j)?null:(0,g.jsxs)("div",{style:{padding:20},children:[(0,g.jsxs)("header",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"2px solid rgba(57,255,20,0.06)",paddingBottom:12},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{style:{color:"var(--color-neon, #39ff14)",fontWeight:700},children:"ADMIN DASHBOARD"}),(0,g.jsxs)("div",{style:{fontSize:13,color:"#ccc"},children:["Organization Overview - ",l&&(l.name||l.email)||"..."]}),(()=>{try{console.debug("analyticsData (admin):",J)}catch(a){}let a=!!(J&&(null!=J.totalRevenue&&0!==J.totalRevenue||Array.isArray(J.campaignStats)&&J.campaignStats.length>0||null!=J.revenue&&0!==J.revenue));return(0,g.jsxs)("div",{style:{marginTop:6,fontSize:12},children:[(0,g.jsx)("span",{style:{color:"#bbb",marginRight:8},children:"Data source:"}),(0,g.jsx)("span",{style:{padding:"2px 8px",borderRadius:6,background:a?"rgba(57,255,20,0.12)":"rgba(255,77,77,0.06)",color:a?"var(--color-neon)":"#ff9a9a",fontWeight:700},children:a?"Live":"Seeded / Local"})]})})()]}),(0,g.jsxs)("div",{style:{display:"flex",gap:12},children:["undefined"!=typeof process&&process.env&&!1,(0,g.jsx)("button",{className:"btn btn-ghost",onClick:function(){try{localStorage.removeItem("token")}catch(a){console.warn("removeItem token failed",a)}try{m(null),K(null),Q([]),G([]),q([]),s([]),u([]),w([]),y([]),A([]),aR&&aR(null),aN&&aN(null),aL&&aL(!1)}catch(a){console.warn("Error clearing client state",a)}try{console.log("Signing out: clearing client state and redirecting"),M("Signed out"),setTimeout(()=>{M(null);try{f.replace("/")}catch(a){console.warn("router.replace failed during sign-out, falling back to location.href",a);try{window.location.href="/"}catch(a){console.warn("Fallback redirect failed",a)}}},800)}catch(a){try{window.location.href="/"}catch(a){console.warn("Redirect failed",a)}}},children:"Logout"})]})]}),L&&(0,g.jsx)("div",{style:{position:"fixed",right:20,top:20,background:"rgba(0,0,0,0.8)",color:"var(--color-neon)",padding:"10px 14px",borderRadius:8,border:"1px solid rgba(57,255,20,0.08)"},children:L}),(0,g.jsxs)("div",{style:{marginTop:18},children:[(0,g.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,g.jsx)("button",{className:`btn ${"users"===D?"btn-primary":""}`,onClick:()=>E("users"),children:"User Management"}),(0,g.jsx)("button",{className:`btn ${"approvals"===D?"btn-primary":""}`,onClick:()=>E("approvals"),children:"Campaign Approvals"}),(0,g.jsx)("button",{className:`btn ${"analytics"===D?"btn-primary":""}`,onClick:()=>E("analytics"),children:"Full Analytics"}),(0,g.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[(0,g.jsx)("button",{className:"btn",onClick:()=>{window.location.href="/admin/donors"},children:"View Donors"}),(0,g.jsx)("button",{className:"btn",onClick:()=>{window.location.href="/admin/campaigns"},children:"View Campaigns"}),(0,g.jsx)("button",{className:"btn btn-danger",onClick:()=>{S(!0)},style:{background:"#ff4d4d",color:"#fff",border:"1px solid rgba(255,77,77,0.9)"},children:"Clear All Data"})]})]}),(0,g.jsxs)("div",{style:{marginTop:12},children:["users"===D&&(0,g.jsxs)("div",{style:{border:"1px solid rgba(57,255,20,0.08)",padding:16,borderRadius:8},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"User Management"}),(0,g.jsx)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:"Manage user roles and permissions"}),(0,g.jsx)("input",{className:"input",placeholder:"Search users...",value:H,onChange:a=>I(a.target.value)}),(0,g.jsx)("div",{style:{marginTop:12,display:"flex",flexDirection:"column",gap:10},children:F.filter(a=>(a.name||a.email||"").toLowerCase().includes(H.toLowerCase())).map(a=>(0,g.jsxs)("div",{style:{padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{style:{fontWeight:700},children:[a.name," ",(0,g.jsx)("span",{style:{background:"ADMIN"===a.role?"var(--color-neon)":"#444",color:"#000",padding:"2px 6px",borderRadius:6,fontSize:12,marginLeft:8},children:a.role.toLowerCase()})]}),(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:a.email})]}),(0,g.jsx)("div",{children:"ADMIN"!==a.role?(0,g.jsx)("button",{className:"btn",onClick:()=>{aa(a),ac("ADMIN"),ae(""),ai(null),$(!0)},children:"Promote to Admin"}):(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{aa(a),ac("TEAM_MEMBER"),ae(""),ai(null),$(!0)},children:"Set as Team Member"})})]},a.id))})]}),"approvals"===D&&(0,g.jsxs)("div",{style:{border:"1px solid rgba(57,255,20,0.08)",padding:16,borderRadius:8},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Campaign Approvals"}),(0,g.jsx)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:"Review and approve events/campaigns"}),(0,g.jsx)("div",{style:{marginTop:12,display:"flex",flexDirection:"column",gap:12},children:P&&0!==P.length?0===(a=Object.values((P||[]).reduce((a,b)=>(a[b.name]||(a[b.name]=b),a),{})).filter(a=>{let b=Number(a.raised||0);return!!(a.approved||b>0)})).length?(0,g.jsx)("div",{style:{color:"#888"},children:"No approved campaigns."}):a.map(a=>{let b=Number(a.raised||0),c=!!(a.approved||b>0);return(0,g.jsxs)("div",{style:{padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{style:{fontWeight:700},children:[a.name," ",(0,g.jsx)("span",{style:{background:c?"rgba(47,255,85,0.06)":"rgba(255,193,7,0.06)",color:c?"var(--color-neon)":"#ffd57a",padding:"2px 6px",borderRadius:6,fontSize:12,marginLeft:8},children:c?"Approved":b>0?"Pending (has funds)":"Pending"})]}),(0,g.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:["Raised: $",b.toLocaleString?b.toLocaleString():b]})]}),(0,g.jsxs)("div",{style:{minWidth:220,textAlign:"right",color:"#bbb",display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,g.jsx)("button",{className:"btn",onClick:()=>{am(a),ao("approve"),aq(""),au(null),ak(!0)},disabled:c,children:"Approve"}),(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{am(a),ao("deactivate"),aq(""),au(null),ak(!0)},disabled:!c,children:"Deactivate"}),!c&&(0,g.jsx)("button",{className:"btn btn-danger",onClick:()=>{confirm("Deny this campaign? This will mark it as not approved.")&&(am(a),ao("deny"),aq(""),au(null),ak(!0))},children:"Deny"}),(0,g.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>{confirm("Delete this campaign? This will remove the campaign and its donations.")&&(ay(a),aA(""),aE(null),aw(!0))},style:{marginLeft:8},children:"Delete"})]})]},a.id||a.name)}):(0,g.jsx)("div",{style:{color:"#888"},children:"No campaigns yet."})})]}),"approvals"!==D&&"users"!==D&&J&&Array.isArray(J.campaignStats)&&J.campaignStats.length>0&&(0,g.jsxs)("div",{style:{marginTop:18},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700,marginBottom:8},children:"Campaigns Quick"}),(0,g.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2,1fr)",gap:12},children:J.campaignStats.map(a=>{let b=Number(a.raised||0),c=Number(a.gifted||0),d=Math.max(0,b-c),e=Number(a.goal||0)||0,f=e?Math.min(100,Math.round(b/e*100)):0,h=!!(a.approved||b>0);return(0,g.jsxs)("div",{style:{padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:8,background:"#070707"},children:[(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{style:{fontWeight:700},children:a.name}),(0,g.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:["Goal: $",e.toLocaleString?e.toLocaleString():e]})]}),(0,g.jsxs)("div",{style:{textAlign:"right"},children:[(0,g.jsxs)("div",{style:{fontWeight:700},children:["$",b.toLocaleString?b.toLocaleString():b]}),(0,g.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:[f,"%"]})]})]}),(0,g.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,g.jsxs)("div",{style:{flex:1,fontSize:13},children:[(0,g.jsxs)("div",{style:{color:"#bbb"},children:["Donations: ",(0,g.jsxs)("strong",{style:{color:"var(--color-neon)"},children:["$",d.toLocaleString?d.toLocaleString():d]})]}),(0,g.jsxs)("div",{style:{color:"#bbb"},children:["In-Kind Gifts: ",(0,g.jsxs)("strong",{style:{color:"#9be"},children:["$",c.toLocaleString?c.toLocaleString():c]})]})]}),(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6,minWidth:180,alignItems:"flex-end"},children:[(0,g.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,g.jsx)("button",{className:"btn",onClick:()=>{am(a),ao("approve"),aq(""),au(null),ak(!0)},disabled:h,children:"Approve"}),(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{am(a),ao("deactivate"),aq(""),au(null),ak(!0)},disabled:!h,children:"Deactivate"}),(0,g.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>{confirm("Delete this campaign? This will remove the campaign and its donations.")&&(ay(a),aA(""),aE(null),aw(!0))},style:{marginLeft:6},children:"Delete"})]}),(0,g.jsx)("div",{style:{fontSize:12,color:h?"var(--color-neon)":"#ffd57a"},children:h?"Approved":"Pending"})]})]})]},a.id)})})]}),"analytics"===D&&(0,g.jsxs)("div",{style:{border:"1px solid rgba(57,255,20,0.08)",padding:16,borderRadius:8},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Full Analytics"}),(0,g.jsx)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:"Complete financial overview across all partners"}),J?(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{style:{display:"flex",gap:12},children:(b=Array.isArray(J?.campaignStats)?J.campaignStats.reduce((a,b)=>a+(Number(b.raised||0)||0),0):0,d=Math.max((c=Math.max((Array.isArray(J?.donorStats)?J.donorStats.reduce((a,b)=>a+(Number(b.totalGiving||0)||0),0):0)||0,1e5))||0,b||0),J?.totalDonors??J?.donorCount,e=Array.isArray(J?.campaignStats)?J.campaignStats.length:Array.isArray(P)?P.length:0,(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Active Programs"}),(0,g.jsx)("div",{style:{fontSize:24,marginTop:8},children:String(e)})]}),(0,g.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Campaign Revenue"}),(0,g.jsxs)("div",{style:{fontSize:24,marginTop:8},children:["$",b.toLocaleString?b.toLocaleString():b]})]}),(0,g.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Donor Revenue"}),(0,g.jsxs)("div",{style:{fontSize:24,marginTop:8},children:["$",c.toLocaleString?c.toLocaleString():c]})]}),(0,g.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Total Revenue"}),(0,g.jsxs)("div",{style:{fontSize:24,marginTop:8},children:["$",d.toLocaleString?d.toLocaleString():d]})]})]}))}),(0,g.jsxs)("div",{style:{marginTop:20},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700,marginBottom:8},children:"All Campaigns"}),(J.campaignStats||[]).map(a=>{let b=Number(a.raised||0),c=a.gifted||null!=a.giftedRaised?Number(a.gifted||a.giftedRaised):null,d=null!=c?c:b,e=Number(a.goal||0)||null,f=e?Math.min(100,Math.round(d/e*100)):null;return(0,g.jsx)("div",{style:{padding:8,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,marginBottom:8},children:(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,g.jsx)("div",{style:{fontWeight:700},children:a.name}),d>0&&(0,g.jsx)("div",{style:{background:"var(--color-neon)",color:"#000",padding:"2px 8px",borderRadius:6,fontSize:12,fontWeight:700},children:"Approved"})]}),(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:a.goal?`Goal: $${a.goal}`:""}),(a.gifted||null!=a.giftedRaised)&&(0,g.jsxs)("div",{style:{fontSize:12,color:"#9be",marginTop:6},children:["Raised (gifts): ",(0,g.jsxs)("strong",{style:{color:"var(--color-neon)"},children:["$",a.gifted||a.giftedRaised||0]})]}),null!=f&&(0,g.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:["Progress: ",(0,g.jsxs)("strong",{style:{color:"var(--color-neon)"},children:[f,"%"]})]})]}),(0,g.jsxs)("div",{style:{textAlign:"right"},children:[(0,g.jsxs)("div",{style:{fontWeight:700},children:["$",d]}),(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:null!=f&&f>0?`${f}%`:""})]})]})},a.id)})]}),(0,g.jsxs)("div",{style:{marginTop:8},children:[(0,g.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700,marginBottom:8},children:"Donor Analytics"}),(J.donorStats||[]).map(a=>(0,g.jsxs)("div",{style:{padding:8,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{style:{fontWeight:700},children:a.name}),(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:a.email})]}),(0,g.jsxs)("div",{style:{textAlign:"right"},children:[(0,g.jsxs)("div",{style:{fontWeight:700},children:["$",Number(a.totalGiving||0).toLocaleString?Number(a.totalGiving||0).toLocaleString():a.totalGiving||0]}),(0,g.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:[a.gifts," gifts"]}),(0,g.jsx)("div",{style:{marginTop:6},children:(0,g.jsx)("button",{className:"btn btn-ghost",onClick:async()=>{try{let b=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})(),c=await fetch(`/api/donors/${a.id}`,{headers:{...b?{Authorization:`Bearer ${b}`}:{}}});if(!c.ok){let a=await c.json().catch(()=>({}));return alert("Unable to load donor: "+(a.error||"unknown"))}let d=await c.json();O({...d.donor,donations:d.donations})}catch(a){console.warn(a),alert("Failed to fetch donor")}},children:"View"})})]})]},a.id))]})]}):(0,g.jsx)("div",{style:{color:"#888"},children:"No analytics available. Seed data and try again."})]})]})]}),R&&(0,g.jsx)("div",{className:"dialog-backdrop",children:(0,g.jsxs)("div",{style:{width:420,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,g.jsx)("h3",{style:{color:"var(--color-neon)"},children:"Confirm Clear All Data"}),(0,g.jsx)("p",{style:{color:"#ddd"},children:"This will permanently delete donors, donations, campaigns and alerts from the database. This cannot be undone."}),(0,g.jsx)("p",{style:{color:"#ffb3b3",fontWeight:700},children:"Type your admin password to confirm."}),(0,g.jsx)("div",{style:{marginTop:8},children:(0,g.jsx)("input",{className:"input",type:"password",value:T,onChange:a=>U(a.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),X&&(0,g.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:X}),(0,g.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{S(!1),U(""),Y(null)},children:"Cancel"}),(0,g.jsx)("button",{className:"btn",onClick:async()=>{W(!0),Y(null);try{let a=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})(),b=await fetch("/api/clear",{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}},body:JSON.stringify({password:T})}),c=await b.json();if(!b.ok)throw Error(c?.error||"Clear failed");q([]),s([]),y([]),A([]),u([]),w([]),C(null),S(!1),U("")}catch(a){Y(a.message)}finally{W(!1)}},style:{background:"#ff4d4d",color:"#fff"},disabled:V,children:V?"Clearing...":"Confirm Clear"})]})]})}),aO&&(0,g.jsx)("div",{className:"dialog-backdrop",children:(0,g.jsxs)("div",{style:{width:720,maxHeight:"70vh",overflow:"auto",background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,g.jsx)("h3",{style:{color:"var(--color-neon)"},children:"Seeder Response"}),(0,g.jsxs)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:["Full response from ",(0,g.jsx)("code",{children:"/api/seed"})]}),(0,g.jsx)("div",{style:{background:"#080808",padding:12,borderRadius:6,color:"#ddd",maxHeight:380,overflow:"auto"},children:(0,g.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",color:"#ddd"},children:JSON.stringify(aQ,null,2)})}),aM&&(0,g.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:aM}),(0,g.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{aP(!1),aR(null),aN(null)},children:"Close"})})]})}),aj&&(0,g.jsx)("div",{className:"dialog-backdrop",children:(0,g.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,g.jsx)("h3",{style:{color:"var(--color-neon)"},children:"approve"===an?"Approve Campaign":"deactivate"===an?"Deactivate Campaign":"Campaign Action"}),(0,g.jsx)("div",{style:{color:"#bbb",marginTop:6},children:al?.name}),(0,g.jsx)("p",{style:{color:"#ddd",marginTop:8},children:"To confirm this action, enter your admin password."}),(0,g.jsx)("div",{style:{marginTop:8},children:(0,g.jsx)("input",{className:"input",type:"password",value:ap,onChange:a=>aq(a.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),at&&(0,g.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:at}),(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{ak(!1),am(null),aq(""),au(null)},children:"Cancel"}),(0,g.jsx)("button",{className:"btn",onClick:async()=>{if(al&&an){as(!0),au(null);try{let a=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})(),b={password:ap};"approve"===an?b.action="approve":"deactivate"===an?b.action="deactivate":"deny"===an&&(b.approved=!1);let c=await fetch(`/api/campaigns/${al.id}/approve`,{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}},body:JSON.stringify(b)}),d=await c.json().catch(()=>null);if(!c.ok){let a=d?.error||"Action failed";au(a+(d?.details?` — ${d.details}`:""));return}try{await Promise.all([aI().catch(()=>{}),aJ().catch(()=>{})])}catch(a){console.warn("Reload after campaign action failed",a)}ak(!1),am(null),aq("")}catch(a){console.warn("Campaign action failed",a),au(String(a))}finally{as(!1)}}},disabled:ar||!ap,children:ar?"Working...":"Confirm"})]})]})}),Z&&(0,g.jsx)("div",{className:"dialog-backdrop",children:(0,g.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,g.jsx)("h3",{style:{color:"var(--color-neon)"},children:"ADMIN"===ab?"Promote to Admin":"Change Role"}),(0,g.jsx)("div",{style:{color:"#bbb",marginTop:6},children:_?_.name||_.email:""}),(0,g.jsx)("p",{style:{color:"#ddd",marginTop:8},children:"Changing a user's role is a privileged action. To confirm, enter your admin password."}),(0,g.jsx)("div",{style:{marginTop:8},children:(0,g.jsx)("input",{className:"input",type:"password",value:ad,onChange:a=>ae(a.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),ah&&(0,g.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:ah}),(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{$(!1),aa(null),ac(null),ae(""),ai(null)},children:"Cancel"}),(0,g.jsx)("button",{className:"btn",onClick:async()=>{if(_&&ab){ag(!0),ai(null);try{let a=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})(),b=await fetch(`/api/users/${_.id}/role`,{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}},body:JSON.stringify({role:ab,password:ad})}),c=await b.json().catch(()=>null);if(!b.ok){let a=c?.error||"Role change failed";ai(a+(c?.details?` — ${c.details}`:""));return}try{await aH()}catch(a){console.warn("Reload users failed",a)}$(!1),aa(null),ac(null),ae("")}catch(a){console.warn("Role change failed",a),ai(String(a))}finally{ag(!1)}}},disabled:af||!ad,children:af?"Working...":"Confirm"})]})]})}),av&&(0,g.jsx)("div",{className:"dialog-backdrop",children:(0,g.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,g.jsx)("h3",{style:{color:"var(--color-neon)"},children:"Delete Campaign"}),(0,g.jsx)("div",{style:{color:"#bbb",marginTop:6},children:ax?.name||ax?.title}),(0,g.jsx)("p",{style:{color:"#ddd",marginTop:8},children:"This will permanently delete the campaign and its donations. To confirm, enter your admin password."}),(0,g.jsx)("div",{style:{marginTop:8},children:(0,g.jsx)("input",{className:"input",type:"password",value:az,onChange:a=>aA(a.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),aD&&(0,g.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:aD}),(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>{aw(!1),ay(null),aA(""),aE(null)},children:"Cancel"}),(0,g.jsx)("button",{className:"btn btn-danger",onClick:async()=>{if(ax){aC(!0),aE(null);try{let a=(()=>{try{return localStorage.getItem("token")}catch(a){return null}})(),b=await fetch("/api/admin/delete-campaign",{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:`Bearer ${a}`}:{}},body:JSON.stringify({password:az,id:ax.id})}),c=await b.json().catch(()=>null);if(!b.ok)return void aE(c?.error||"Delete failed");try{await Promise.all([aI().catch(()=>{}),aJ().catch(()=>{})])}catch(a){console.warn("Reload after delete failed",a)}aw(!1),ay(null),aA("")}catch(a){console.warn("Manual delete failed",a),aE(String(a))}finally{aC(!1)}}},disabled:aB||!az,children:aB?"Deleting...":"Delete"})]})]})}),N&&(0,g.jsx)("div",{className:"dialog-backdrop",children:(0,g.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,g.jsx)("h3",{style:{color:"var(--color-neon)"},children:N.name}),(0,g.jsx)("div",{style:{color:"#bbb",marginTop:6},children:N.email}),(0,g.jsxs)("div",{style:{display:"flex",gap:12,marginTop:12},children:[(0,g.jsxs)("div",{style:{flex:1,padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6},children:[(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:"Total Giving"}),(0,g.jsxs)("div",{style:{fontWeight:700,fontSize:18},children:["$",N.totalGiving]})]}),(0,g.jsxs)("div",{style:{flex:1,padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6},children:[(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:"Gifts"}),(0,g.jsx)("div",{style:{fontWeight:700,fontSize:18},children:N.gifts})]})]}),N.donations&&N.donations.length>0&&(0,g.jsxs)("div",{style:{marginTop:12},children:[(0,g.jsx)("div",{style:{fontWeight:700,color:"var(--color-neon)",marginBottom:8},children:"Donation History"}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:N.donations.map(a=>(0,g.jsxs)("div",{style:{padding:8,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,display:"flex",justifyContent:"space-between"},children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{style:{fontWeight:700},children:["$",a.amount]}),(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:new Date(a.date).toLocaleDateString()})]}),(0,g.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:a.campaignId?`Campaign: ${a.campaignId}`:""})]},a.id))})]}),(0,g.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:(0,g.jsx)("button",{className:"btn btn-ghost",onClick:()=>O(null),children:"Close"})})]})})]})}a.s(["default",()=>j],63685);var k=a.i(63685),l=a.i(9193);let m=(0,d.hoist)(k,"default"),n=(0,d.hoist)(k,"getStaticProps"),o=(0,d.hoist)(k,"getStaticPaths"),p=(0,d.hoist)(k,"getServerSideProps"),q=(0,d.hoist)(k,"config"),r=(0,d.hoist)(k,"reportWebVitals"),s=(0,d.hoist)(k,"unstable_getStaticProps"),t=(0,d.hoist)(k,"unstable_getStaticPaths"),u=(0,d.hoist)(k,"unstable_getStaticParams"),v=(0,d.hoist)(k,"unstable_getServerProps"),w=(0,d.hoist)(k,"unstable_getServerSideProps"),x=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/admin",pathname:"/admin",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:k}),y=(0,l.getHandler)({srcPage:"/admin",config:q,userland:k,routeModule:x,getStaticPaths:o,getStaticProps:n,getServerSideProps:p});a.s(["config",0,q,"default",0,m,"getServerSideProps",0,p,"getStaticPaths",0,o,"getStaticProps",0,n,"handler",0,y,"reportWebVitals",0,r,"routeModule",0,x,"unstable_getServerProps",0,v,"unstable_getServerSideProps",0,w,"unstable_getStaticParams",0,u,"unstable_getStaticPaths",0,t,"unstable_getStaticProps",0,s],58456)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_pages_ed76ede3.js.map