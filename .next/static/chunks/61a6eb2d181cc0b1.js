(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20955,(e,t,n)=>{var r={229:function(e){var t,n,r,a=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}var s=[],c=!1,d=-1;function u(){c&&r&&(c=!1,r.length?s=r.concat(s):d=-1,s.length&&f())}function f(){if(!c){var e=l(u);c=!0;for(var t=s.length;t;){for(r=s,s=[];++d<t;)r&&r[d].run();d=-1,t=s.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new p(e,t)),1!==s.length||c||l(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}},o=!0;try{r[e](n,n.exports,i),o=!1}finally{o&&delete a[e]}return n.exports}i.ab="/ROOT/node_modules/next/dist/compiled/process/",t.exports=i(229)},50461,(e,t,n)=>{"use strict";var r,a;t.exports=(null==(r=e.g.process)?void 0:r.env)&&"object"==typeof(null==(a=e.g.process)?void 0:a.env)?e.g.process:e.r(20955)},8481,(e,t,n)=>{"use strict";var r=Symbol.for("react.transitional.element");function a(e,t,n){var a=null;if(void 0!==n&&(a=""+n),void 0!==t.key&&(a=""+t.key),"key"in t)for(var i in n={},t)"key"!==i&&(n[i]=t[i]);else n=t;return{$$typeof:r,type:e,key:a,ref:void 0!==(t=n.ref)?t:null,props:n}}n.Fragment=Symbol.for("react.fragment"),n.jsx=a,n.jsxs=a},91398,(e,t,n)=>{"use strict";t.exports=e.r(8481)},41705,(e,t,n)=>{"use strict";n._=function(e){return e&&e.__esModule?e:{default:e}}},61556,(e,t,n)=>{"use strict";var r=e.i(50461),a=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),y=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,v={};function x(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}function j(){}function S(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},j.prototype=x.prototype;var w=S.prototype=new j;w.constructor=S,b(w,x.prototype),w.isPureReactComponent=!0;var k=Array.isArray;function C(){}var A={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function R(e,t,n){var r=n.ref;return{$$typeof:a,type:e,key:t,ref:void 0!==r?r:null,props:n}}function N(e){return"object"==typeof e&&null!==e&&e.$$typeof===a}var _=/\/+/g;function E(e,t){var n,r;return"object"==typeof e&&null!==e&&null!=e.key?(n=""+e.key,r={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(e){return r[e]})):t.toString(36)}function $(e,t,n){if(null==e)return e;var r=[],o=0;return!function e(t,n,r,o,l){var s,c,d,u=typeof t;("undefined"===u||"boolean"===u)&&(t=null);var f=!1;if(null===t)f=!0;else switch(u){case"bigint":case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case a:case i:f=!0;break;case g:return e((f=t._init)(t._payload),n,r,o,l)}}if(f)return l=l(t),f=""===o?"."+E(t,0):o,k(l)?(r="",null!=f&&(r=f.replace(_,"$&/")+"/"),e(l,n,r,"",function(e){return e})):null!=l&&(N(l)&&(s=l,c=r+(null==l.key||t&&t.key===l.key?"":(""+l.key).replace(_,"$&/")+"/")+f,l=R(s.type,c,s.props)),n.push(l)),1;f=0;var p=""===o?".":o+":";if(k(t))for(var h=0;h<t.length;h++)u=p+E(o=t[h],h),f+=e(o,n,r,u,l);else if("function"==typeof(h=null===(d=t)||"object"!=typeof d?null:"function"==typeof(d=y&&d[y]||d["@@iterator"])?d:null))for(t=h.call(t),h=0;!(o=t.next()).done;)u=p+E(o=o.value,h++),f+=e(o,n,r,u,l);else if("object"===u){if("function"==typeof t.then)return e(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(C,C):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(t),n,r,o,l);throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(n=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.")}return f}(e,r,"","",function(e){return t.call(n,e,o++)}),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof r.default&&"function"==typeof r.default.emit)return void r.default.emit("uncaughtException",e);console.error(e)};n.Activity=h,n.Children={map:$,forEach:function(e,t,n){$(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return $(e,function(){t++}),t},toArray:function(e){return $(e,function(e){return e})||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},n.Component=x,n.Fragment=o,n.Profiler=s,n.PureComponent=S,n.StrictMode=l,n.Suspense=f,n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,n.__COMPILER_RUNTIME={__proto__:null,c:function(e){return A.H.useMemoCache(e)}},n.cache=function(e){return function(){return e.apply(null,arguments)}},n.cacheSignal=function(){return null},n.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var r=b({},e.props),a=e.key;if(null!=t)for(i in void 0!==t.key&&(a=""+t.key),t)T.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&("ref"!==i||void 0!==t.ref)&&(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];r.children=o}return R(e.type,a,r)},n.createContext=function(e){return(e={$$typeof:d,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:c,_context:e},e},n.createElement=function(e,t,n){var r,a={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)T.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var o=arguments.length-2;if(1===o)a.children=n;else if(1<o){for(var l=Array(o),s=0;s<o;s++)l[s]=arguments[s+2];a.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===a[r]&&(a[r]=o[r]);return R(e,i,a)},n.createRef=function(){return{current:null}},n.forwardRef=function(e){return{$$typeof:u,render:e}},n.isValidElement=N,n.lazy=function(e){return{$$typeof:g,_payload:{_status:-1,_result:e},_init:D}},n.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},n.startTransition=function(e){var t=A.T,n={};A.T=n;try{var r=e(),a=A.S;null!==a&&a(n,r),"object"==typeof r&&null!==r&&"function"==typeof r.then&&r.then(C,P)}catch(e){P(e)}finally{null!==t&&null!==n.types&&(t.types=n.types),A.T=t}},n.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},n.use=function(e){return A.H.use(e)},n.useActionState=function(e,t,n){return A.H.useActionState(e,t,n)},n.useCallback=function(e,t){return A.H.useCallback(e,t)},n.useContext=function(e){return A.H.useContext(e)},n.useDebugValue=function(){},n.useDeferredValue=function(e,t){return A.H.useDeferredValue(e,t)},n.useEffect=function(e,t){return A.H.useEffect(e,t)},n.useEffectEvent=function(e){return A.H.useEffectEvent(e)},n.useId=function(){return A.H.useId()},n.useImperativeHandle=function(e,t,n){return A.H.useImperativeHandle(e,t,n)},n.useInsertionEffect=function(e,t){return A.H.useInsertionEffect(e,t)},n.useLayoutEffect=function(e,t){return A.H.useLayoutEffect(e,t)},n.useMemo=function(e,t){return A.H.useMemo(e,t)},n.useOptimistic=function(e,t){return A.H.useOptimistic(e,t)},n.useReducer=function(e,t,n){return A.H.useReducer(e,t,n)},n.useRef=function(e){return A.H.useRef(e)},n.useState=function(e){return A.H.useState(e)},n.useSyncExternalStore=function(e,t,n){return A.H.useSyncExternalStore(e,t,n)},n.useTransition=function(){return A.H.useTransition()},n.version="19.2.3"},91788,(e,t,n)=>{"use strict";t.exports=e.r(61556)},13584,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"HeadManagerContext",{enumerable:!0,get:function(){return r}});let r=e.r(41705)._(e.r(91788)).default.createContext({})},94470,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},52456,(e,t,n)=>{"use strict";function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}n._=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var a={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=i?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(a,o,l):a[o]=e[o]}return a.default=e,n&&n.set(e,a),a}},89129,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={DecodeError:function(){return m},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return x},NormalizeError:function(){return b},PageNotFoundError:function(){return v},SP:function(){return h},ST:function(){return y},WEB_VITALS:function(){return i},execOnce:function(){return o},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return s},isResSent:function(){return f},loadGetInitialProps:function(){return g},normalizeRepeatedSlashes:function(){return p},stringifyError:function(){return S}};for(var a in r)Object.defineProperty(n,a,{enumerable:!0,get:r[a]});let i=["CLS","FCP","FID","INP","LCP","TTFB"];function o(e){let t,n=!1;return(...r)=>(n||(n=!0,t=e(...r)),t)}let l=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,s=e=>l.test(e);function c(){let{protocol:e,hostname:t,port:n}=window.location;return`${e}//${t}${n?":"+n:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function f(e){return e.finished||e.headersSent}function p(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function g(e,t){let n=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await g(t.Component,t.ctx)}:{};let r=await e.getInitialProps(t);if(n&&f(n))return r;if(!r)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${r}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return r}let h="undefined"!=typeof performance,y=h&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class m extends Error{}class b extends Error{}class v extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class x extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function S(e){return JSON.stringify({message:e.message,stack:e.stack})}},3828,(e,t,n)=>{t.exports=e.r(26990)},60981,e=>{"use strict";var t=e.i(50461),n=e.i(91398),r=e.i(91788),a=e.i(3828);function i(){let e,i,o,l,s,c=(0,a.useRouter)(),[d,u]=(0,r.useState)(!0),[f,p]=(0,r.useState)(null),[g,h]=(0,r.useState)(null),[y,m]=(0,r.useState)([]),[b,v]=(0,r.useState)([]),[x,j]=(0,r.useState)([]),[S,w]=(0,r.useState)([]),[k,C]=(0,r.useState)([]),[A,T]=(0,r.useState)([]),[R,N]=(0,r.useState)(null),[_,E]=(0,r.useState)("analytics"),[$,D]=(0,r.useState)([]),[P,O]=(0,r.useState)(""),[L,z]=(0,r.useState)(null),[M,I]=(0,r.useState)(null),[W,B]=(0,r.useState)(null),[H,G]=(0,r.useState)([]),[F,U]=(0,r.useState)(!1),[V,q]=(0,r.useState)(""),[J,Q]=(0,r.useState)(!1),[X,K]=(0,r.useState)(null),[Z,Y]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(null),[en,er]=(0,r.useState)(null),[ea,ei]=(0,r.useState)(""),[eo,el]=(0,r.useState)(!1),[es,ec]=(0,r.useState)(null),[ed,eu]=(0,r.useState)(!1),[ef,ep]=(0,r.useState)(null),[eg,eh]=(0,r.useState)(null),[ey,em]=(0,r.useState)(""),[eb,ev]=(0,r.useState)(!1),[ex,ej]=(0,r.useState)(null),[eS,ew]=(0,r.useState)(!1),[ek,eC]=(0,r.useState)(null),[eA,eT]=(0,r.useState)(""),[eR,eN]=(0,r.useState)(!1),[e_,eE]=(0,r.useState)(null);async function e$(){try{let e=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})(),t=await fetch("/api/seed",{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:`Bearer ${e}`}:{}}});if(!t.ok)return console.warn("Seed API failed, falling back to local seed"),eD();let n=await t.json();return m(n.metrics||[]),v(n.partners||[]),C(n.donors||[]),T(n.campaigns||[]),j(n.recentActivity||[]),w(n.alerts||[]),N(n.analytics||null),n}catch(e){return console.warn("Seed failed",e),eD()}}function eD(){return m([{title:"Active Programs",value:"1",sub:"Running programs"},{title:"Total Revenue",value:"$500,000",sub:"From all programs"},{title:"Team Reminders",value:"0",sub:"Action items pending"}]),v([{name:"GameStop",tag:"At Risk",health:"45%"},{name:"Discord",tag:"Pending",health:"70%"},{name:"Alienware",tag:"Active",health:"85%"},{name:"Red Bull Gaming",tag:"Active",health:"92%"}]),C([{name:"Nate Marshall",totalGiving:"$12,500",lastGift:"Mar 3, 2025"},{name:"Evelyn Hart",totalGiving:"$4,200",lastGift:"Jan 12, 2025"}]),T([{title:"Spring Fundraiser 2025",goal:"$75,000",raised:"$12,000"},{title:"Community Outreach Q2",goal:"$20,000",raised:"$5,000"}]),j([{title:"Alienware",kind:"Email",note:"Equipment delivery confirmed for new venue opening.",date:"Dec 7, 2025"},{title:"Red Bull Gaming",kind:"Meeting",note:"Discussed Q1 2025 tournament schedule and activation opportunities.",date:"Dec 4, 2025"}]),w([{title:"Alienware",note:"Send co-marketing proposal and content calendar — Due: Dec 14, 2025"},{title:"Red Bull Gaming",note:"Reach out to discuss 2025 renewal terms — Due: Dec 19, 2025"}]),N({visitors:1234,conversions:42,revenue:5e5}),{metrics:[{title:"Active Programs",value:"1",sub:"Running programs"},{title:"Total Revenue",value:"$500,000",sub:"From all programs"},{title:"Team Reminders",value:"0",sub:"Action items pending"}],partners:[{name:"GameStop",tag:"At Risk",health:"45%"},{name:"Discord",tag:"Pending",health:"70%"},{name:"Alienware",tag:"Active",health:"85%"},{name:"Red Bull Gaming",tag:"Active",health:"92%"}],donors:[{name:"Nate Marshall",totalGiving:"$12,500",lastGift:"Mar 3, 2025"},{name:"Evelyn Hart",totalGiving:"$4,200",lastGift:"Jan 12, 2025"}],campaigns:[{title:"Spring Fundraiser 2025",goal:"$75,000",raised:"$12,000"},{title:"Community Outreach Q2",goal:"$20,000",raised:"$5,000"}],recentActivity:[{title:"Alienware",kind:"Email",note:"Equipment delivery confirmed for new venue opening.",date:"Dec 7, 2025"},{title:"Red Bull Gaming",kind:"Meeting",note:"Discussed Q1 2025 tournament schedule and activation opportunities.",date:"Dec 4, 2025"}],alerts:[{title:"Alienware",note:"Send co-marketing proposal and content calendar — Due: Dec 14, 2025"},{title:"Red Bull Gaming",note:"Reach out to discuss 2025 renewal terms — Due: Dec 19, 2025"}],analytics:{visitors:1234,conversions:42,revenue:5e5}}}async function eP(e){try{let t=await fetch("/api/users"),n=await t.json(),r=n;if(!n||(0===n.totalRevenue||null==n.totalRevenue)&&(0===n.totalDonors||null==n.totalDonors)&&(!Array.isArray(n.campaignStats)||0===n.campaignStats.length))try{let e=await e$();e&&(r=e.analytics||e)}catch(e){console.warn("Auto-seed failed",e)}z(r);let a=[];if(Array.isArray(n)?a=n:Array.isArray(n?.users)?a=n.users:Array.isArray(r?.users)&&(a=r.users),!a||0===a.length)try{e?a=[e]:f&&(a=[f])}catch(e){a=[]}D(a||[])}catch(e){console.warn("loadUsers failed",e)}}async function eO(){try{let e=await fetch("/api/campaigns");if(!e.ok)return;let t=await e.json();if(!t||!Array.isArray(t.campaigns)||0===t.campaigns.length)try{let e=await e$();if(e&&Array.isArray(e.campaigns)){T(e.campaigns),G(e.campaigns);return}}catch(e){console.warn("Auto-seed for campaigns failed",e)}T(t.campaigns||[]),G(t.campaigns||[])}catch(e){console.warn(e)}}async function eL(){try{let e=await fetch("/api/analytics");if(!e.ok)return;let t=await e.json();if(!t||(0===t.totalRevenue||null==t.totalRevenue)&&(!Array.isArray(t.campaignStats)||0===t.campaignStats.length))try{let e=await e$();if(e)return void z(e.analytics||e)}catch(e){console.warn("Auto-seed for analytics failed",e)}try{let e=await fetch("/api/campaigns");if(e.ok){let n=await e.json(),r=Array.isArray(n.campaigns)?n.campaigns:[];if(Array.isArray(t.campaignStats)&&t.campaignStats.length>0&&r.length>0){let e=r.reduce((e,t)=>(t.id&&(e[t.id]=t),e[t.name]=e[t.name]||t,e),{}),n=t.campaignStats.map(t=>{let n=t.id&&e[t.id]||e[t.name];if(!n)return t;let r=Number(t.raised||0),a=Number(n.raised||n.raisedAmount||0),i=Number(t.gifted||t.giftedRaised||0),o=Number(n.giftedRaised||n.gifted||0);return{...t,raised:r&&r>0?r:a,gifted:i&&i>0?i:o}});t.campaignStats=n}}}catch(e){console.warn("Failed to enrich analytics with /api/campaigns data",e)}z(t||null)}catch(e){console.warn(e)}}(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{let t=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})();if(!t){e&&h("Not authenticated");return}let n=await fetch("/api/protected",{headers:{Authorization:`Bearer ${t}`}});if(!n.ok){e&&h("Session invalid or expired");try{localStorage.removeItem("token")}catch(e){}return}let r=await n.json();if(!r?.user){e&&h("Unable to load user");return}if("ADMIN"!==r.user.role){e&&h("Unauthorized — admin access required");return}e&&p(r.user),e&&(eP(r.user).catch(()=>{}),eO().catch(()=>{}),eL().catch(()=>{}))}catch(t){e&&h("Network error")}finally{e&&u(!1)}})(),()=>{e=!1}},[]);let[ez,eM]=(0,r.useState)(!1),[eI,eW]=(0,r.useState)(null),[eB,eH]=(0,r.useState)(!1),[eG,eF]=(0,r.useState)(null);return((()=>{if(L){let e=Array.isArray(L.campaignStats)?L.campaignStats.reduce((e,t)=>e+(Number(t.raised||0)||0),0):0,t=Array.isArray(L.donorStats)?L.donorStats.reduce((e,t)=>e+(Number(t.totalGiving||0)||0),0):0,n=Math.max(t||0,e||0);return e.toLocaleString&&e.toLocaleString(),t.toLocaleString&&t.toLocaleString(),n.toLocaleString&&n.toLocaleString()}Array.isArray(y)&&y.length})(),d)?null:(0,n.jsxs)("div",{style:{padding:20},children:[(0,n.jsxs)("header",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"2px solid rgba(57,255,20,0.06)",paddingBottom:12},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{color:"var(--color-neon, #39ff14)",fontWeight:700},children:"ADMIN DASHBOARD"}),(0,n.jsxs)("div",{style:{fontSize:13,color:"#ccc"},children:["Organization Overview - ",f&&(f.name||f.email)||"..."]}),(()=>{try{console.debug("analyticsData (admin):",L)}catch(e){}let e=!!(L&&(null!=L.totalRevenue&&0!==L.totalRevenue||Array.isArray(L.campaignStats)&&L.campaignStats.length>0||null!=L.revenue&&0!==L.revenue));return(0,n.jsxs)("div",{style:{marginTop:6,fontSize:12},children:[(0,n.jsx)("span",{style:{color:"#bbb",marginRight:8},children:"Data source:"}),(0,n.jsx)("span",{style:{padding:"2px 8px",borderRadius:6,background:e?"rgba(57,255,20,0.12)":"rgba(255,77,77,0.06)",color:e?"var(--color-neon)":"#ff9a9a",fontWeight:700},children:e?"Live":"Seeded / Local"})]})})()]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[void 0!==t.default&&t.default.env&&!1,(0,n.jsx)("button",{className:"btn btn-ghost",onClick:function(){try{localStorage.removeItem("token")}catch(e){console.warn("removeItem token failed",e)}try{p(null),z(null),G([]),D([]),m([]),v([]),j([]),w([]),C([]),T([]),eF&&eF(null),eW&&eW(null),eM&&eM(!1)}catch(e){console.warn("Error clearing client state",e)}try{console.log("Signing out: clearing client state and redirecting"),I("Signed out"),setTimeout(()=>{I(null);try{c.replace("/")}catch(e){console.warn("router.replace failed during sign-out, falling back to location.href",e);try{window.location.href="/"}catch(e){console.warn("Fallback redirect failed",e)}}},800)}catch(e){try{window.location.href="/"}catch(e){console.warn("Redirect failed",e)}}},children:"Logout"})]})]}),M&&(0,n.jsx)("div",{style:{position:"fixed",right:20,top:20,background:"rgba(0,0,0,0.8)",color:"var(--color-neon)",padding:"10px 14px",borderRadius:8,border:"1px solid rgba(57,255,20,0.08)"},children:M}),(0,n.jsxs)("div",{style:{marginTop:18},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsx)("button",{className:`btn ${"users"===_?"btn-primary":""}`,onClick:()=>E("users"),children:"User Management"}),(0,n.jsx)("button",{className:`btn ${"approvals"===_?"btn-primary":""}`,onClick:()=>E("approvals"),children:"Campaign Approvals"}),(0,n.jsx)("button",{className:`btn ${"analytics"===_?"btn-primary":""}`,onClick:()=>E("analytics"),children:"Full Analytics"}),(0,n.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[(0,n.jsx)("button",{className:"btn",onClick:()=>{window.location.href="/admin/donors"},children:"View Donors"}),(0,n.jsx)("button",{className:"btn",onClick:()=>{window.location.href="/admin/campaigns"},children:"View Campaigns"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:()=>{U(!0)},style:{background:"#ff4d4d",color:"#fff",border:"1px solid rgba(255,77,77,0.9)"},children:"Clear All Data"})]})]}),(0,n.jsxs)("div",{style:{marginTop:12},children:["users"===_&&(0,n.jsxs)("div",{style:{border:"1px solid rgba(57,255,20,0.08)",padding:16,borderRadius:8},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"User Management"}),(0,n.jsx)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:"Manage user roles and permissions"}),(0,n.jsx)("input",{className:"input",placeholder:"Search users...",value:P,onChange:e=>O(e.target.value)}),(0,n.jsx)("div",{style:{marginTop:12,display:"flex",flexDirection:"column",gap:10},children:$.filter(e=>(e.name||e.email||"").toLowerCase().includes(P.toLowerCase())).map(e=>(0,n.jsxs)("div",{style:{padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:[e.name," ",(0,n.jsx)("span",{style:{background:"ADMIN"===e.role?"var(--color-neon)":"#444",color:"#000",padding:"2px 6px",borderRadius:6,fontSize:12,marginLeft:8},children:e.role.toLowerCase()})]}),(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:e.email})]}),(0,n.jsx)("div",{children:"ADMIN"!==e.role?(0,n.jsx)("button",{className:"btn",onClick:()=>{et(e),er("ADMIN"),ei(""),ec(null),Y(!0)},children:"Promote to Admin"}):(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{et(e),er("TEAM_MEMBER"),ei(""),ec(null),Y(!0)},children:"Set as Team Member"})})]},e.id))})]}),"approvals"===_&&(0,n.jsxs)("div",{style:{border:"1px solid rgba(57,255,20,0.08)",padding:16,borderRadius:8},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Campaign Approvals"}),(0,n.jsx)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:"Review and approve events/campaigns"}),(0,n.jsx)("div",{style:{marginTop:12,display:"flex",flexDirection:"column",gap:12},children:H&&0!==H.length?0===(e=Object.values((H||[]).reduce((e,t)=>(e[t.name]||(e[t.name]=t),e),{})).filter(e=>{let t=Number(e.raised||0);return!!(e.approved||t>0)})).length?(0,n.jsx)("div",{style:{color:"#888"},children:"No approved campaigns."}):e.map(e=>{let t=Number(e.raised||0),r=!!(e.approved||t>0);return(0,n.jsxs)("div",{style:{padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:[e.name," ",(0,n.jsx)("span",{style:{background:r?"rgba(47,255,85,0.06)":"rgba(255,193,7,0.06)",color:r?"var(--color-neon)":"#ffd57a",padding:"2px 6px",borderRadius:6,fontSize:12,marginLeft:8},children:r?"Approved":t>0?"Pending (has funds)":"Pending"})]}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:["Raised: $",t.toLocaleString?t.toLocaleString():t]})]}),(0,n.jsxs)("div",{style:{minWidth:220,textAlign:"right",color:"#bbb",display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,n.jsx)("button",{className:"btn",onClick:()=>{ep(e),eh("approve"),em(""),ej(null),eu(!0)},disabled:r,children:"Approve"}),(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{ep(e),eh("deactivate"),em(""),ej(null),eu(!0)},disabled:!r,children:"Deactivate"}),!r&&(0,n.jsx)("button",{className:"btn btn-danger",onClick:()=>{confirm("Deny this campaign? This will mark it as not approved.")&&(ep(e),eh("deny"),em(""),ej(null),eu(!0))},children:"Deny"}),(0,n.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>{confirm("Delete this campaign? This will remove the campaign and its donations.")&&(eC(e),eT(""),eE(null),ew(!0))},style:{marginLeft:8},children:"Delete"})]})]},e.id||e.name)}):(0,n.jsx)("div",{style:{color:"#888"},children:"No campaigns yet."})})]}),"approvals"!==_&&"users"!==_&&L&&Array.isArray(L.campaignStats)&&L.campaignStats.length>0&&(0,n.jsxs)("div",{style:{marginTop:18},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700,marginBottom:8},children:"Campaigns Quick"}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2,1fr)",gap:12},children:L.campaignStats.map(e=>{let t=Number(e.raised||0),r=Number(e.gifted||0),a=Math.max(0,t-r),i=Number(e.goal||0)||0,o=i?Math.min(100,Math.round(t/i*100)):0,l=!!(e.approved||t>0);return(0,n.jsxs)("div",{style:{padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:8,background:"#070707"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:700},children:e.name}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:["Goal: $",i.toLocaleString?i.toLocaleString():i]})]}),(0,n.jsxs)("div",{style:{textAlign:"right"},children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:["$",t.toLocaleString?t.toLocaleString():t]}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:[o,"%"]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,n.jsxs)("div",{style:{flex:1,fontSize:13},children:[(0,n.jsxs)("div",{style:{color:"#bbb"},children:["Donations: ",(0,n.jsxs)("strong",{style:{color:"var(--color-neon)"},children:["$",a.toLocaleString?a.toLocaleString():a]})]}),(0,n.jsxs)("div",{style:{color:"#bbb"},children:["In-Kind Gifts: ",(0,n.jsxs)("strong",{style:{color:"#9be"},children:["$",r.toLocaleString?r.toLocaleString():r]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6,minWidth:180,alignItems:"flex-end"},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,n.jsx)("button",{className:"btn",onClick:()=>{ep(e),eh("approve"),em(""),ej(null),eu(!0)},disabled:l,children:"Approve"}),(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{ep(e),eh("deactivate"),em(""),ej(null),eu(!0)},disabled:!l,children:"Deactivate"}),(0,n.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>{confirm("Delete this campaign? This will remove the campaign and its donations.")&&(eC(e),eT(""),eE(null),ew(!0))},style:{marginLeft:6},children:"Delete"})]}),(0,n.jsx)("div",{style:{fontSize:12,color:l?"var(--color-neon)":"#ffd57a"},children:l?"Approved":"Pending"})]})]})]},e.id)})})]}),"analytics"===_&&(0,n.jsxs)("div",{style:{border:"1px solid rgba(57,255,20,0.08)",padding:16,borderRadius:8},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Full Analytics"}),(0,n.jsx)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:"Complete financial overview across all partners"}),L?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{display:"flex",gap:12},children:(i=Array.isArray(L?.campaignStats)?L.campaignStats.reduce((e,t)=>e+(Number(t.raised||0)||0),0):0,l=Math.max((o=Math.max((Array.isArray(L?.donorStats)?L.donorStats.reduce((e,t)=>e+(Number(t.totalGiving||0)||0),0):0)||0,1e5))||0,i||0),L?.totalDonors??L?.donorCount,s=Array.isArray(L?.campaignStats)?L.campaignStats.length:Array.isArray(H)?H.length:0,(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Active Programs"}),(0,n.jsx)("div",{style:{fontSize:24,marginTop:8},children:String(s)})]}),(0,n.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Campaign Revenue"}),(0,n.jsxs)("div",{style:{fontSize:24,marginTop:8},children:["$",i.toLocaleString?i.toLocaleString():i]})]}),(0,n.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Donor Revenue"}),(0,n.jsxs)("div",{style:{fontSize:24,marginTop:8},children:["$",o.toLocaleString?o.toLocaleString():o]})]}),(0,n.jsxs)("div",{style:{flex:1,border:"1px solid rgba(255,255,255,0.03)",padding:12,borderRadius:6},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700},children:"Total Revenue"}),(0,n.jsxs)("div",{style:{fontSize:24,marginTop:8},children:["$",l.toLocaleString?l.toLocaleString():l]})]})]}))}),(0,n.jsxs)("div",{style:{marginTop:20},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700,marginBottom:8},children:"All Campaigns"}),(L.campaignStats||[]).map(e=>{let t=Number(e.raised||0),r=e.gifted||null!=e.giftedRaised?Number(e.gifted||e.giftedRaised):null,a=null!=r?r:t,i=Number(e.goal||0)||null,o=i?Math.min(100,Math.round(a/i*100)):null;return(0,n.jsx)("div",{style:{padding:8,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,marginBottom:8},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)("div",{style:{fontWeight:700},children:e.name}),a>0&&(0,n.jsx)("div",{style:{background:"var(--color-neon)",color:"#000",padding:"2px 8px",borderRadius:6,fontSize:12,fontWeight:700},children:"Approved"})]}),(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:e.goal?`Goal: $${e.goal}`:""}),(e.gifted||null!=e.giftedRaised)&&(0,n.jsxs)("div",{style:{fontSize:12,color:"#9be",marginTop:6},children:["Raised (gifts): ",(0,n.jsxs)("strong",{style:{color:"var(--color-neon)"},children:["$",e.gifted||e.giftedRaised||0]})]}),null!=o&&(0,n.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:["Progress: ",(0,n.jsxs)("strong",{style:{color:"var(--color-neon)"},children:[o,"%"]})]})]}),(0,n.jsxs)("div",{style:{textAlign:"right"},children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:["$",a]}),(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:null!=o&&o>0?`${o}%`:""})]})]})},e.id)})]}),(0,n.jsxs)("div",{style:{marginTop:8},children:[(0,n.jsx)("div",{style:{color:"var(--color-neon)",fontWeight:700,marginBottom:8},children:"Donor Analytics"}),(L.donorStats||[]).map(e=>(0,n.jsxs)("div",{style:{padding:8,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontWeight:700},children:e.name}),(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:e.email})]}),(0,n.jsxs)("div",{style:{textAlign:"right"},children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:["$",Number(e.totalGiving||0).toLocaleString?Number(e.totalGiving||0).toLocaleString():e.totalGiving||0]}),(0,n.jsxs)("div",{style:{fontSize:12,color:"#bbb"},children:[e.gifts," gifts"]}),(0,n.jsx)("div",{style:{marginTop:6},children:(0,n.jsx)("button",{className:"btn btn-ghost",onClick:async()=>{try{let t=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})(),n=await fetch(`/api/donors/${e.id}`,{headers:{...t?{Authorization:`Bearer ${t}`}:{}}});if(!n.ok){let e=await n.json().catch(()=>({}));return alert("Unable to load donor: "+(e.error||"unknown"))}let r=await n.json();B({...r.donor,donations:r.donations})}catch(e){console.warn(e),alert("Failed to fetch donor")}},children:"View"})})]})]},e.id))]})]}):(0,n.jsx)("div",{style:{color:"#888"},children:"No analytics available. Seed data and try again."})]})]})]}),F&&(0,n.jsx)("div",{className:"dialog-backdrop",children:(0,n.jsxs)("div",{style:{width:420,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,n.jsx)("h3",{style:{color:"var(--color-neon)"},children:"Confirm Clear All Data"}),(0,n.jsx)("p",{style:{color:"#ddd"},children:"This will permanently delete donors, donations, campaigns and alerts from the database. This cannot be undone."}),(0,n.jsx)("p",{style:{color:"#ffb3b3",fontWeight:700},children:"Type your admin password to confirm."}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("input",{className:"input",type:"password",value:V,onChange:e=>q(e.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),X&&(0,n.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:X}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{U(!1),q(""),K(null)},children:"Cancel"}),(0,n.jsx)("button",{className:"btn",onClick:async()=>{Q(!0),K(null);try{let e=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})(),t=await fetch("/api/clear",{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:`Bearer ${e}`}:{}},body:JSON.stringify({password:V})}),n=await t.json();if(!t.ok)throw Error(n?.error||"Clear failed");m([]),v([]),C([]),T([]),j([]),w([]),N(null),U(!1),q("")}catch(e){K(e.message)}finally{Q(!1)}},style:{background:"#ff4d4d",color:"#fff"},disabled:J,children:J?"Clearing...":"Confirm Clear"})]})]})}),eB&&(0,n.jsx)("div",{className:"dialog-backdrop",children:(0,n.jsxs)("div",{style:{width:720,maxHeight:"70vh",overflow:"auto",background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,n.jsx)("h3",{style:{color:"var(--color-neon)"},children:"Seeder Response"}),(0,n.jsxs)("div",{style:{fontSize:13,color:"#bbb",marginBottom:8},children:["Full response from ",(0,n.jsx)("code",{children:"/api/seed"})]}),(0,n.jsx)("div",{style:{background:"#080808",padding:12,borderRadius:6,color:"#ddd",maxHeight:380,overflow:"auto"},children:(0,n.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",color:"#ddd"},children:JSON.stringify(eG,null,2)})}),eI&&(0,n.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:eI}),(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{eH(!1),eF(null),eW(null)},children:"Close"})})]})}),ed&&(0,n.jsx)("div",{className:"dialog-backdrop",children:(0,n.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,n.jsx)("h3",{style:{color:"var(--color-neon)"},children:"approve"===eg?"Approve Campaign":"deactivate"===eg?"Deactivate Campaign":"Campaign Action"}),(0,n.jsx)("div",{style:{color:"#bbb",marginTop:6},children:ef?.name}),(0,n.jsx)("p",{style:{color:"#ddd",marginTop:8},children:"To confirm this action, enter your admin password."}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("input",{className:"input",type:"password",value:ey,onChange:e=>em(e.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),ex&&(0,n.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:ex}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{eu(!1),ep(null),em(""),ej(null)},children:"Cancel"}),(0,n.jsx)("button",{className:"btn",onClick:async()=>{if(ef&&eg){ev(!0),ej(null);try{let e=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})(),t={password:ey};"approve"===eg?t.action="approve":"deactivate"===eg?t.action="deactivate":"deny"===eg&&(t.approved=!1);let n=await fetch(`/api/campaigns/${ef.id}/approve`,{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:`Bearer ${e}`}:{}},body:JSON.stringify(t)}),r=await n.json().catch(()=>null);if(!n.ok){let e=r?.error||"Action failed";ej(e+(r?.details?` — ${r.details}`:""));return}try{await Promise.all([eO().catch(()=>{}),eL().catch(()=>{})])}catch(e){console.warn("Reload after campaign action failed",e)}eu(!1),ep(null),em("")}catch(e){console.warn("Campaign action failed",e),ej(String(e))}finally{ev(!1)}}},disabled:eb||!ey,children:eb?"Working...":"Confirm"})]})]})}),Z&&(0,n.jsx)("div",{className:"dialog-backdrop",children:(0,n.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,n.jsx)("h3",{style:{color:"var(--color-neon)"},children:"ADMIN"===en?"Promote to Admin":"Change Role"}),(0,n.jsx)("div",{style:{color:"#bbb",marginTop:6},children:ee?ee.name||ee.email:""}),(0,n.jsx)("p",{style:{color:"#ddd",marginTop:8},children:"Changing a user's role is a privileged action. To confirm, enter your admin password."}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("input",{className:"input",type:"password",value:ea,onChange:e=>ei(e.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),es&&(0,n.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:es}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{Y(!1),et(null),er(null),ei(""),ec(null)},children:"Cancel"}),(0,n.jsx)("button",{className:"btn",onClick:async()=>{if(ee&&en){el(!0),ec(null);try{let e=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})(),t=await fetch(`/api/users/${ee.id}/role`,{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:`Bearer ${e}`}:{}},body:JSON.stringify({role:en,password:ea})}),n=await t.json().catch(()=>null);if(!t.ok){let e=n?.error||"Role change failed";ec(e+(n?.details?` — ${n.details}`:""));return}try{await eP()}catch(e){console.warn("Reload users failed",e)}Y(!1),et(null),er(null),ei("")}catch(e){console.warn("Role change failed",e),ec(String(e))}finally{el(!1)}}},disabled:eo||!ea,children:eo?"Working...":"Confirm"})]})]})}),eS&&(0,n.jsx)("div",{className:"dialog-backdrop",children:(0,n.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,n.jsx)("h3",{style:{color:"var(--color-neon)"},children:"Delete Campaign"}),(0,n.jsx)("div",{style:{color:"#bbb",marginTop:6},children:ek?.name||ek?.title}),(0,n.jsx)("p",{style:{color:"#ddd",marginTop:8},children:"This will permanently delete the campaign and its donations. To confirm, enter your admin password."}),(0,n.jsx)("div",{style:{marginTop:8},children:(0,n.jsx)("input",{className:"input",type:"password",value:eA,onChange:e=>eT(e.target.value),placeholder:"Admin password",autoComplete:"current-password"})}),e_&&(0,n.jsx)("div",{style:{color:"#ff8080",marginTop:8},children:e_}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>{ew(!1),eC(null),eT(""),eE(null)},children:"Cancel"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:async()=>{if(ek){eN(!0),eE(null);try{let e=(()=>{try{return localStorage.getItem("token")}catch(e){return null}})(),t=await fetch("/api/admin/delete-campaign",{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:`Bearer ${e}`}:{}},body:JSON.stringify({password:eA,id:ek.id})}),n=await t.json().catch(()=>null);if(!t.ok)return void eE(n?.error||"Delete failed");try{await Promise.all([eO().catch(()=>{}),eL().catch(()=>{})])}catch(e){console.warn("Reload after delete failed",e)}ew(!1),eC(null),eT("")}catch(e){console.warn("Manual delete failed",e),eE(String(e))}finally{eN(!1)}}},disabled:eR||!eA,children:eR?"Deleting...":"Delete"})]})]})}),W&&(0,n.jsx)("div",{className:"dialog-backdrop",children:(0,n.jsxs)("div",{style:{width:520,background:"var(--color-off-black)",border:"1px solid rgba(255,255,255,0.04)",padding:18,borderRadius:8},children:[(0,n.jsx)("h3",{style:{color:"var(--color-neon)"},children:W.name}),(0,n.jsx)("div",{style:{color:"#bbb",marginTop:6},children:W.email}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,marginTop:12},children:[(0,n.jsxs)("div",{style:{flex:1,padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6},children:[(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:"Total Giving"}),(0,n.jsxs)("div",{style:{fontWeight:700,fontSize:18},children:["$",W.totalGiving]})]}),(0,n.jsxs)("div",{style:{flex:1,padding:12,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6},children:[(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:"Gifts"}),(0,n.jsx)("div",{style:{fontWeight:700,fontSize:18},children:W.gifts})]})]}),W.donations&&W.donations.length>0&&(0,n.jsxs)("div",{style:{marginTop:12},children:[(0,n.jsx)("div",{style:{fontWeight:700,color:"var(--color-neon)",marginBottom:8},children:"Donation History"}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:W.donations.map(e=>(0,n.jsxs)("div",{style:{padding:8,border:"1px solid rgba(255,255,255,0.03)",borderRadius:6,display:"flex",justifyContent:"space-between"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{fontWeight:700},children:["$",e.amount]}),(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:new Date(e.date).toLocaleDateString()})]}),(0,n.jsx)("div",{style:{fontSize:12,color:"#bbb"},children:e.campaignId?`Campaign: ${e.campaignId}`:""})]},e.id))})]}),(0,n.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:(0,n.jsx)("button",{className:"btn btn-ghost",onClick:()=>B(null),children:"Close"})})]})})]})}e.s(["default",()=>i])},39304,(e,t,n)=>{let r="/admin";(window.__NEXT_P=window.__NEXT_P||[]).push([r,()=>e.r(60981)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([r])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/fd7c0943d5cd5e09.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);