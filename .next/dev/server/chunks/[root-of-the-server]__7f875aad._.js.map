{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Launchpad8/Nerd-Street-CRM/lib/auth.js"],"sourcesContent":["import jwt from 'jsonwebtoken'\r\nimport { PrismaClient } from '@prisma/client'\r\n\r\nconst prisma = global.__prisma || new PrismaClient()\r\nif (!global.__prisma) global.__prisma = prisma\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'dev-secret'\r\nconst JWT_EXPIRES_IN = '7d'\r\n\r\nexport function signToken(payload) {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN })\r\n}\r\n\r\nexport function verifyToken(token) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET)\r\n  } catch (err) {\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getUserFromToken(token) {\r\n  const data = verifyToken(token)\r\n  if (!data || !data.userId) return null\r\n  const user = await prisma.user.findUnique({ where: { id: data.userId } })\r\n  return user\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,yDAAO,QAAQ,IAAI,IAAI,6IAAY;AAClD,IAAI,CAAC,yDAAO,QAAQ,EAAE,yDAAO,QAAQ,GAAG;AAExC,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,iBAAiB;AAEhB,SAAS,UAAU,OAAO;IAC/B,OAAO,4HAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAe;AACnE;AAEO,SAAS,YAAY,KAAK;IAC/B,IAAI;QACF,OAAO,4HAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,KAAK;QACZ,OAAO;IACT;AACF;AAEO,eAAe,iBAAiB,KAAK;IAC1C,MAAM,OAAO,YAAY;IACzB,IAAI,CAAC,QAAQ,CAAC,KAAK,MAAM,EAAE,OAAO;IAClC,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE,IAAI,KAAK,MAAM;QAAC;IAAE;IACvE,OAAO;AACT"}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Launchpad8/Nerd-Street-CRM/pages/api/protected.js"],"sourcesContent":["import { getUserFromToken } from '../../lib/auth'\r\n\r\nexport default async function handler(req, res) {\r\n  const auth = req.headers?.authorization || req.headers?.Authorization || ''\r\n  const token = auth.startsWith('Bearer ') ? auth.slice(7) : null\r\n  if (!token) return res.status(401).json({ error: 'Missing authorization token' })\r\n\r\n  const user = await getUserFromToken(token)\r\n  if (!user) return res.status(401).json({ error: 'Invalid or expired token' })\r\n\r\n  return res.status(200).json({ ok: true, user: { id: user.id, email: user.email, name: user.name, role: user.role } })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,MAAM,OAAO,IAAI,OAAO,EAAE,iBAAiB,IAAI,OAAO,EAAE,iBAAiB;IACzE,MAAM,QAAQ,KAAK,UAAU,CAAC,aAAa,KAAK,KAAK,CAAC,KAAK;IAC3D,IAAI,CAAC,OAAO,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAA8B;IAE/E,MAAM,OAAO,MAAM,IAAA,wHAAgB,EAAC;IACpC,IAAI,CAAC,MAAM,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAA2B;IAE3E,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,IAAI;QAAM,MAAM;YAAE,IAAI,KAAK,EAAE;YAAE,OAAO,KAAK,KAAK;YAAE,MAAM,KAAK,IAAI;YAAE,MAAM,KAAK,IAAI;QAAC;IAAE;AACrH"}}]
}